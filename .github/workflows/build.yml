name: Emacs on windows dotfile building
run-name: ${{ github.actor }} is build and packaging Emacs dotfiles üöÄ
on: [push]
jobs:
  emacs-dotfile-build:
    runs-on: windows-latest
    steps:
      # - name: Check out repository code
      #   uses: actions/checkout@v3
      - name: Download Emacs binary and uncompress it.
        run: |
          curl -LO https://github.com/kiennq/emacs-build/releases/download/v30.172.20230101.8aae5fb/emacs-master-x86_64-full.zip;
          unzip emacs-master-x86_64-full.zip -d emacs-bin;
      - name: Fetch Emacs version
        run: |
          $env:Path="${{ github.workspace }}\emacs-bin\bin;$env:Path" & echo $(& ${{ github.workspace }}\emacs-bin\bin\emacs.exe --version)
      - name: Clone my doom emacs configuration
        run: |
          git clone --depth 1 https://github.com/doomemacs/doomemacs.git $HOME\.emacs.d;
          git clone https://github.com/MoozIiSP/doom-emacs-private.git $HOME\.doom.d;
        run: ls $HOME
      - name: configure ~/.emacs.d/bin/doom
        run: |
          & $HOME\.emacs.d\bin\doom install
      - name: packaging
        run: |
          tar czf doomemacs-dotfiles-cache.tgz $HOME\.emacs.d $HOME\.doom.d
      - name: List files in the repository
        run: |
          ls ${{ github.workspace }}
      - run: echo "üçè This job's status is ${{ job.status }}."